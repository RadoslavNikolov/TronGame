(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58beaa8c"],{5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,i){var a=i("1d80"),n=i("5899"),o="["+n+"]",s=RegExp("^"+o+o+"*"),r=RegExp(o+o+"*$"),l=function(t){return function(e){var i=String(a(e));return 1&t&&(i=i.replace(s,"")),2&t&&(i=i.replace(r,"")),i}};t.exports={start:l(1),end:l(2),trim:l(3)}},7156:function(t,e,i){var a=i("861d"),n=i("d2bb");t.exports=function(t,e,i){var o,s;return n&&"function"==typeof(o=e.constructor)&&o!==i&&a(s=o.prototype)&&s!==i.prototype&&n(t,s),t}},"74fd":function(t,e,i){"use strict";var a=i("efaa"),n=i.n(a);n.a},"7d36":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"d-flex justify-content-between mt-3 mb-3"},[i("h4",[t._v("Game board")]),i("div",[i("b-button-group",[t.gameStarted&&!t.gamePaused?i("b-button",{attrs:{variant:"warning",disabled:!t.isAuthenticated},on:{click:function(e){return e.stopPropagation(),t.pauseGame(e)}}},[i("i",{staticClass:"fas fa-pause"}),t._v(" Pause")]):t._e(),t.gameStarted&&t.gamePaused?i("b-button",{attrs:{variant:"success",disabled:!t.isAuthenticated},on:{click:function(e){return e.stopPropagation(),t.resumeGame(e)}}},[i("i",{staticClass:"fas fa-play"}),t._v(" Resume")]):t._e(),i("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.liveChatModal",modifiers:{liveChatModal:!0}}],attrs:{variant:"secondary",disabled:!t.isAuthenticated}},[i("i",{staticClass:"fas fa-comments"}),t._v(" Live chat")]),i("b-button",{attrs:{variant:"danger",disabled:!t.isAuthenticated},on:{click:function(e){return e.stopPropagation(),t.leaveTheGame(e)}}},[i("i",{staticClass:"fas fa-sign-out-alt"}),t._v(" Leave")])],1)],1)]),i("div",{staticClass:"d-flex justify-content-between"},[t.myself?i("player-profile",{attrs:{model:t.myself}}):t._e(),t.opponent?i("player-profile",{attrs:{model:t.opponent}}):t._e()],1),i("div",{attrs:{id:"canvas-container"}},[i("canvas",{directives:[{name:"show",rawName:"v-show",value:t.gameStarted,expression:"gameStarted"}],ref:"my-canvas",attrs:{id:"myCanvas",width:t.game.width,height:t.game.height}})]),i("game-stats-modal",{attrs:{stats:t.stats},on:{closed:t.onStatsModalClose},model:{value:t.statisticsModalShow,callback:function(e){t.statisticsModalShow=e},expression:"statisticsModalShow"}})],1)},n=[],o=(i("fb6a"),i("45fc"),i("b0c0"),i("a9e3"),i("d3b7"),i("25f0"),i("5530")),s=i("2f62");i("cb29");function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function u(t,e,i){return e&&l(t.prototype,e),i&&l(t,i),t}var c=function(){function t(){r(this,t)}return u(t,[{key:"gameTick",value:function(t,e,i,a,n,o){t?(t.direction=i.direction,t.points=n):t=i,e?(e.direction=a.direction,e.points=o):e=a}},{key:"draw",value:function(t,e,i,a,n){var o=t.context;if(o.clearRect(0,0,e.width,e.height),i&&i.points){o.beginPath();for(var s=0;s<i.points.length;s++){var r=i.points[s];r.topLeft={x:r.x*n,y:r.y*n},r.bottomRight={x:r.topLeft.x+n,y:r.topLeft.y+n},o.fillStyle=i.color,o.rect(r.topLeft.x,r.topLeft.y,n,n),o.fill()}o.closePath()}if(a&&a.points){o.beginPath();for(var l=0;l<a.points.length;l++){var u=a.points[l];u.topLeft={x:u.x*n,y:u.y*n},u.bottomRight={x:u.topLeft.x+n,y:u.topLeft.y+n},o.fillStyle=a.color,o.rect(u.topLeft.x,u.topLeft.y,n,n),o.fill()}o.closePath()}}}]),t}(),m=new c,h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-modal",{ref:"gameStatisticsModal",attrs:{id:"gameStatisticsModal","hide-footer":"",title:"Game statistics"},on:{hidden:t.onHidden},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[a("b-form-group",[t.isWinner?a("div",{staticClass:"text-center"},[a("img",{attrs:{src:i("e5e1")}})]):t._e(),a("div",{staticClass:"text-center"},[t.isWinner?a("div",[a("h4",[t._v("You are the winner!")])]):a("div",[a("h4",[t._v("You lose!")]),a("h4",[t._v("The winner is "),a("strong",[t._v(t._s(t.statistics.winner)+" ")])])]),a("h5",[t._v("Score: "+t._s(t.statistics.score))])])]),a("button",{staticClass:"btn btn-secondary float-right",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.onOk(e)}}},[t._v("Ok")])],1)},f=[],d={props:{stats:Object,value:Boolean},data:function(){return{statistics:this.stats,showModal:this.value}},methods:{onOk:function(){this.$refs.gameStatisticsModal.hide()},onHidden:function(){Object.assign(this.statistics,{winner:"",score:""}),this.$emit("closed")}},computed:Object(o["a"])({},Object(s["c"])("context",["userName","userEmail"]),{isWinner:function(){return this.statistics.winner&&(this.statistics.winner===this.userName||this.statistics.winner===this.userEmail)}}),watch:{value:function(t){this.showModal=t}}},p=d,g=i("2877"),v=Object(g["a"])(p,h,f,!1,null,null,null),b=v.exports,y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{},[i("div",{staticClass:"text-center"},[i("div",[i("span",{class:t.avatarClass},[i("i",{staticClass:"fas fa-user-circle fa-5x"})])]),i("h5",[t._v(t._s(t.model.userEmail))])])])},w=[],x={name:"PlayerProfile",props:{model:{type:Object,required:!0}},date:function(){},mounted:function(){},computed:{avatarClass:function(){var t;switch(null===(t=this.model)||void 0===t?void 0:t.color){case"red":return"text-danger";case"blue":return"text-info";default:break}return""}}},$=x,k=Object(g["a"])($,y,w,!1,null,null,null),N=k.exports,S={name:"GameBoard",components:{GameStatsModal:b,PlayerProfile:N},props:{gameUid:String,playerNumStr:[Number,String]},data:function(){return{player1:{},player2:{},keysToDirections:{37:"left",38:"up",39:"right",40:"down"},playerNum:Number(this.playerNumStr),game:{},provider:{context:null},defaultTimerInterval:600,interval:null,counter:0,gameStarted:!1,gamePaused:!1,outOfBoundaries:!1,collisionDetected:!1,stats:{},statisticsModalShow:!1,workerActions:[{message:"outOfBoundariesCheck",func:function(t,e,i){if(!t||t.length<=0)return!1;var a=t[0];return a.topLeft.x<=0||a.topLeft.y<=0||a.bottomRight.x<=0||a.bottomRight.y<=0||(a.topLeft.x>=e||a.bottomRight.x>=e||a.topLeft.y>=i||a.bottomRight.y>=i)}},{message:"collideOpponentCheck",func:function(t,e){return!(!t||!e||e.length<=0)&&e.some((function(e){return t.topLeft.x<e.bottomRight.x&&t.bottomRight.x>e.topLeft.x&&t.topLeft.y<e.bottomRight.y&&t.bottomRight.y>e.topLeft.y}))}},{message:"collideMyselfCheck",func:function(t){if(!t||t.length<=0)return!1;var e=t[0];return t.slice(1).some((function(t){return e.topLeft.x<t.bottomRight.x&&e.bottomRight.x>t.topLeft.x&&e.topLeft.y<t.bottomRight.y&&e.bottomRight.y>t.topLeft.y}))}}],worker:null}},computed:Object(o["a"])({},Object(s["d"])("context",["profile"]),{},Object(s["c"])("context",["isAuthenticated","userName","userEmail"]),{timerInerval:function(){return this.game.level?this.defaultTimerInterval/this.game.level:this.defaultTimerInterval},elementSize:function(){return this.game&&this.game.elementSize?this.game.elementSize:8},myself:function(){return 1===this.playerNum?this.player1:this.player2},opponent:function(){return 1===this.playerNum?this.player2:this.player1}}),created:function(){this.joinGame({gameUid:this.gameUid}),this.$mainHub.$on("game-player-joined",this.onPlayerJoined),this.$mainHub.$on("game-player-left",this.onPlayerLeft),this.$mainHub.$on("game-start",this.onGameStart),this.$mainHub.$on("game-ticked",this.onGameTicked),this.$mainHub.$on("game-over",this.onGameOver),this.$mainHub.$on("game-paused",this.onGamePaused),this.$mainHub.$on("game-resumed",this.onGameResumed),this.$mainHub.joinGame(this.gameUid,this.profile.email,this.playerNum),window.addEventListener("keydown",this.onKeyPress),this.worker=this.$worker.create(this.workerActions)},mounted:function(){this.provider.context=this.$refs["my-canvas"].getContext("2d")},beforeDestroy:function(){this.leaveGame({gameUid:null}),this.$mainHub.$off("game-player-joined",this.onPlayerJoined),this.$mainHub.$off("game-player-left",this.onPlayerLeft),this.$mainHub.$off("game-start",this.onGameStart),this.$mainHub.$off("game-ticked",this.onGameTicked),this.$mainHub.$off("game-over",this.onGameOver),this.$mainHub.$off("game-paused",this.onGamePaused),this.$mainHub.$off("game-resumed",this.onGameResumed),window.removeEventListener("keydown",this.onKeyPress),this.worker=null},methods:Object(o["a"])({},Object(s["b"])("context",["joinGame","leaveGame"]),{leaveTheGame:function(t){var e=this;t?this.$mainHub.leaveGame(this.gameUid,this.profile.email,Number(this.playerNum)).then((function(){e.$router.push("/")})).catch((function(){})):this.$bvModal.msgBoxConfirm("Are you sure you want to leave the game?",{title:"Game exit",size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:"YES",cancelTitle:"NO",footerClass:"p-2",hideHeaderClose:!1,centered:!0}).then((function(t){t&&e.$mainHub.leaveGame(e.gameUid,e.profile.email,Number(e.playerNum)).then((function(){e.$router.push("/")})).catch((function(){}))})).catch((function(){}))},pauseGame:function(){this.$mainHub.pauseGame(this.gameUid,this.profile.email)},resumeGame:function(){this.$mainHub.resumeGame(this.gameUid,this.profile.email)},onPlayerJoined:function(t,e,i){this.setPlayers(e,i)},onPlayerLeft:function(t,e,i,a){var n=this;this.setPlayers(i,a),this.$bvModal.msgBoxOk("".concat(e," left the game!")).then((function(){n.leaveTheGame(!0)})).catch((function(){}))},setPlayers:function(t,e){this.player1=Object(o["a"])({},t,{userName:null===t||void 0===t?void 0:t.name,userEmail:null===t||void 0===t?void 0:t.name,color:"red"}),this.player2=Object(o["a"])({},e,{userName:null===e||void 0===e?void 0:e.name,userEmail:null===e||void 0===e?void 0:e.name,color:"blue"})},playerMove:function(t,e,i){this.$mainHub.playerMove(t,e,i)},onGameStart:function(t){this.game=t,this.gameStarted=!0,1===this.playerNum&&this.setInterval()},onGameTicked:function(t,e,i,a,n,o){var s=this;this.counter=e,m.gameTick(this.player1,this.player2,i,a,n,o),this.startDraw(),this.worker.postMessage("outOfBoundariesCheck",[this.myself.points,this.game.width,this.game.height]).then((function(t){t&&(s.outOfBoundaries=!0,s.$mainHub.outOfTheBoundaries(s.gameUid,s.profile.email,Number(s.playerNum)))})).catch(),this.worker.postMessage("collideOpponentCheck",[this.myself.points[0],this.opponent.points]).then((function(t){t&&(s.collisionDetected=!0,s.$mainHub.outOfTheBoundaries(s.gameUid,s.profile.email,Number(s.playerNum)))})).catch(),this.worker.postMessage("collideMyselfCheck",[this.myself.points]).then((function(t){t&&(s.collisionDetected=!0,s.$mainHub.outOfTheBoundaries(s.gameUid,s.profile.email,Number(s.playerNum)))})).catch()},onGameOver:function(t,e,i){this.gameStarted=!1,this.stats.winner=e,this.stats.score=i,this.showGameStatistics()},onGamePaused:function(t,e){this.gamePaused=!0,this.$bvToast.toast(e,{toaster:"b-toaster-bottom-full",title:"Game paused",variant:"warning",solid:!0,appendToast:!0})},onGameResumed:function(t,e){this.gamePaused=!1,this.$bvToast.toast(e,{toaster:"b-toaster-bottom-right",title:"Game resumed",variant:"info",solid:!0,appendToast:!0})},showGameStatistics:function(){this.statisticsModalShow=!0},startDraw:function(){var t=this,e=function e(){m.draw(t.provider,t.game,t.player1,t.player2,t.elementSize),requestAnimationFrame(e)};e()},onKeyPress:function(t){var e=this.keysToDirections[t.keyCode];this.gameStarted&&e&&(console.log(e),this.playerMove(this.gameUid,this.playerNum,e))},setInterval:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=this;this.interval=setInterval((function(){t.gameStarted&&!t.gamePaused&&t.gameTick()}),this.timerInerval)})),gameTick:function(){this.$mainHub.gameTick(this.gameUid)},onStatsModalClose:function(){Object.assign(this.stats,{winner:"",score:""}),this.statisticsModalShow=!1,this.$router.push("/")}}),watch:{outOfBoundaries:function(t){t&&this.$bvToast.toast("You went out of boudaries!",{toaster:"b-toaster-bottom-right",title:"Out of boudaries",variant:"warning",solid:!0,appendToast:!0})},collisionDetected:function(t){t&&this.$bvToast.toast("You collided youself ot your opponent!",{toaster:"b-toaster-bottom-right",title:"Collision detected",variant:"warning",solid:!0,appendToast:!0})}}},G=S,O=(i("74fd"),Object(g["a"])(G,a,n,!1,null,"44945d07",null));e["default"]=O.exports},"81d5":function(t,e,i){"use strict";var a=i("7b0b"),n=i("23cb"),o=i("50c4");t.exports=function(t){var e=a(this),i=o(e.length),s=arguments.length,r=n(s>1?arguments[1]:void 0,i),l=s>2?arguments[2]:void 0,u=void 0===l?i:n(l,i);while(u>r)e[r++]=t;return e}},a9e3:function(t,e,i){"use strict";var a=i("83ab"),n=i("da84"),o=i("94ca"),s=i("6eeb"),r=i("5135"),l=i("c6b6"),u=i("7156"),c=i("c04e"),m=i("d039"),h=i("7c73"),f=i("241c").f,d=i("06cf").f,p=i("9bf2").f,g=i("58a8").trim,v="Number",b=n[v],y=b.prototype,w=l(h(y))==v,x=function(t){var e,i,a,n,o,s,r,l,u=c(t,!1);if("string"==typeof u&&u.length>2)if(u=g(u),e=u.charCodeAt(0),43===e||45===e){if(i=u.charCodeAt(2),88===i||120===i)return NaN}else if(48===e){switch(u.charCodeAt(1)){case 66:case 98:a=2,n=49;break;case 79:case 111:a=8,n=55;break;default:return+u}for(o=u.slice(2),s=o.length,r=0;r<s;r++)if(l=o.charCodeAt(r),l<48||l>n)return NaN;return parseInt(o,a)}return+u};if(o(v,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var $,k=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof k&&(w?m((function(){y.valueOf.call(i)})):l(i)!=v)?u(new b(x(e)),i,k):x(e)},N=a?f(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;N.length>S;S++)r(b,$=N[S])&&!r(k,$)&&p(k,$,d(b,$));k.prototype=y,y.constructor=k,s(n,v,k)}},cb29:function(t,e,i){var a=i("23e7"),n=i("81d5"),o=i("44d2");a({target:"Array",proto:!0},{fill:n}),o("fill")},e5e1:function(t,e,i){t.exports=i.p+"img/cup1.075ad50e.png"},efaa:function(t,e,i){}}]);
//# sourceMappingURL=chunk-58beaa8c.e68e462f.js.map