(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-92f80c4c"],{5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,i){var a=i("1d80"),n=i("5899"),s="["+n+"]",o=RegExp("^"+s+s+"*"),r=RegExp(s+s+"*$"),u=function(t){return function(e){var i=String(a(e));return 1&t&&(i=i.replace(o,"")),2&t&&(i=i.replace(r,"")),i}};t.exports={start:u(1),end:u(2),trim:u(3)}},7156:function(t,e,i){var a=i("861d"),n=i("d2bb");t.exports=function(t,e,i){var s,o;return n&&"function"==typeof(s=e.constructor)&&s!==i&&a(o=s.prototype)&&o!==i.prototype&&n(t,o),t}},"7d36":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h4",[t._v("Game board")]),i("h5",[t._v(t._s(t.gameUid))]),i("h5",[t._v(t._s(t.playerNum))]),i("h5",[t._v(t._s(t.counter))]),i("br"),i("div",{staticClass:"mt-3 mb-3"},[i("b-button-group",[t.gameStarted&&!t.gamePaused?i("b-button",{attrs:{variant:"warning",disabled:!t.isAuthenticated},on:{click:function(e){return e.stopPropagation(),t.pauseGame(e)}}},[i("i",{staticClass:"fas fa-pause"}),t._v(" Pause")]):t._e(),t.gameStarted&&t.gamePaused?i("b-button",{attrs:{variant:"success",disabled:!t.isAuthenticated},on:{click:function(e){return e.stopPropagation(),t.resumeGame(e)}}},[i("i",{staticClass:"fas fa-play"}),t._v(" Resume")]):t._e(),i("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.liveChatModal",modifiers:{liveChatModal:!0}}],attrs:{variant:"secondary",disabled:!t.isAuthenticated}},[i("i",{staticClass:"fas fa-comments"}),t._v(" Live chat")]),i("b-button",{attrs:{variant:"danger",disabled:!t.isAuthenticated},on:{click:function(e){return e.stopPropagation(),t.leaveTheGame(e)}}},[i("i",{staticClass:"fas fa-sign-out-alt"}),t._v(" Leave")])],1)],1),i("div",{staticClass:"d-flex justify-content-between"},[i("div",{staticClass:"text-danger",class:t.player1&&t.userEmail===t.player1.name?"me":""},[t._v(t._s(t.player1?t.player1.name:""))]),i("div",{staticClass:"text-primary",class:t.player2&&t.userEmail===t.player2.name?"me":""},[t._v(t._s(t.player2?t.player2.name:""))])]),i("div",{staticClass:"d-flex justify-content-between"},[i("div",[t._v(t._s(t.player1?t.player1.direction:""))]),i("div",[t._v(t._s(t.player2?t.player2.direction:""))])]),i("div",{attrs:{id:"canvas-container"}},[i("canvas",{directives:[{name:"show",rawName:"v-show",value:t.gameStarted,expression:"gameStarted"}],ref:"my-canvas",attrs:{id:"myCanvas",width:t.game.width,height:t.game.height}})]),i("game-stats-modal",{attrs:{stats:t.stats},on:{closed:t.onStatsModalClose},model:{value:t.statisticsModalShow,callback:function(e){t.statisticsModalShow=e},expression:"statisticsModalShow"}})],1)},n=[],s=(i("fb6a"),i("45fc"),i("a9e3"),i("d3b7"),i("25f0"),i("5530")),o=i("2f62");i("cb29");function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function c(t,e,i){return e&&u(t.prototype,e),i&&u(t,i),t}var l=function(){function t(){r(this,t)}return c(t,[{key:"gameTick",value:function(t,e,i,a,n,s){t?(t.direction=i.direction,t.points=n):t=i,e?(e.direction=a.direction,e.points=s):e=a}},{key:"draw",value:function(t,e,i,a,n){var s=t.context;if(s.clearRect(0,0,e.width,e.height),i&&i.points){s.beginPath();for(var o=0;o<i.points.length;o++){var r=i.points[o];r.topLeft={x:r.x*n,y:r.y*n},r.bottomRight={x:r.topLeft.x+n,y:r.topLeft.y+n},s.fillStyle="red",s.rect(r.topLeft.x,r.topLeft.y,n,n),s.fill()}s.closePath()}if(a&&a.points){s.beginPath();for(var u=0;u<a.points.length;u++){var c=a.points[u];c.topLeft={x:c.x*n,y:c.y*n},c.bottomRight={x:c.topLeft.x+n,y:c.topLeft.y+n},s.fillStyle="blue",s.rect(c.topLeft.x,c.topLeft.y,n,n),s.fill()}s.closePath()}}}]),t}(),h=new l,m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-modal",{ref:"gameStatisticsModal",attrs:{id:"gameStatisticsModal","hide-footer":"",title:"Game statistics"},on:{hidden:t.onHidden},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[a("b-form-group",[t.isWinner?a("div",{staticClass:"text-center"},[a("img",{attrs:{src:i("e5e1")}})]):t._e(),a("div",{staticClass:"text-center"},[t.isWinner?a("div",[a("h4",[t._v("You are the winner!")])]):a("div",[a("h4",[t._v("You lose!")]),a("h4",[t._v("The winner is "),a("strong",[t._v(t._s(t.statistics.winner)+" ")])])]),a("h5",[t._v("Score: "+t._s(t.statistics.score))])])]),a("button",{staticClass:"btn btn-secondary float-right",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.onOk(e)}}},[t._v("Ok")])],1)},f=[],d={props:{stats:Object,value:Boolean},data:function(){return{statistics:this.stats,showModal:this.value}},methods:{onOk:function(){this.$refs.gameStatisticsModal.hide()},onHidden:function(){Object.assign(this.statistics,{winner:"",score:""}),this.$emit("closed")}},computed:Object(s["a"])({},Object(o["c"])("context",["userName","userEmail"]),{isWinner:function(){return this.statistics.winner&&(this.statistics.winner===this.userName||this.statistics.winner===this.userEmail)}}),watch:{value:function(t){this.showModal=t}}},p=d,g=i("2877"),v=Object(g["a"])(p,m,f,!1,null,null,null),b=v.exports,y={name:"GameBoard",components:{GameStatsModal:b},props:{gameUid:String,playerNumStr:[Number,String]},data:function(){return{player1:{},player2:{},keysToDirections:{37:"left",38:"up",39:"right",40:"down"},playerNum:Number(this.playerNumStr),game:{},provider:{context:null},defaultTimerInterval:900,interval:null,counter:0,gameStarted:!1,gamePaused:!1,outOfBoundaries:!1,collisionDetected:!1,stats:{},statisticsModalShow:!1,workerActions:[{message:"outOfBoundariesCheck",func:function(t,e,i){if(!t||t.length<=0)return!1;var a=t[0];return a.topLeft.x<=0||a.topLeft.y<=0||a.bottomRight.x<=0||a.bottomRight.y<=0||(a.topLeft.x>=e||a.bottomRight.x>=e||a.topLeft.y>=i||a.bottomRight.y>=i)}},{message:"collideOpponentCheck",func:function(t,e){return!(!t||!e||e.length<=0)&&e.some((function(e){return t.topLeft.x<e.bottomRight.x&&t.bottomRight.x>e.topLeft.x&&t.topLeft.y<e.bottomRight.y&&t.bottomRight.y>e.topLeft.y}))}},{message:"collideMyselfCheck",func:function(t){if(!t||t.length<=0)return!1;var e=t[0];return t.slice(1).some((function(t){return e.topLeft.x<t.bottomRight.x&&e.bottomRight.x>t.topLeft.x&&e.topLeft.y<t.bottomRight.y&&e.bottomRight.y>t.topLeft.y}))}}],worker:null}},computed:Object(s["a"])({},Object(o["d"])("context",["profile"]),{},Object(o["c"])("context",["isAuthenticated","userName","userEmail"]),{timerInerval:function(){return this.game.level?this.defaultTimerInterval/this.game.level:this.defaultTimerInterval},elementSize:function(){return this.game&&this.game.elementSize?this.game.elementSize:8},myself:function(){return 1===this.playerNum?this.player1:this.player2},opponent:function(){return 1===this.playerNum?this.player2:this.player1}}),created:function(){this.$mainHub.$on("game-player-joined",this.onPlayerJoined),this.$mainHub.$on("game-player-left",this.onPlayerLeft),this.$mainHub.$on("game-start",this.onGameStart),this.$mainHub.$on("game-ticked",this.onGameTicked),this.$mainHub.$on("game-over",this.onGameOver),this.$mainHub.$on("game-paused",this.onGamePaused),this.$mainHub.$on("game-resumed",this.onGameResumed),this.$mainHub.joinGame(this.gameUid,this.profile.email,this.playerNum),window.addEventListener("keydown",this.onKeyPress),this.worker=this.$worker.create(this.workerActions)},mounted:function(){this.provider.context=this.$refs["my-canvas"].getContext("2d")},beforeDestroy:function(){this.$mainHub.$off("game-player-joined",this.onPlayerJoined),this.$mainHub.$off("game-player-left",this.onPlayerLeft),this.$mainHub.$off("game-start",this.onGameStart),this.$mainHub.$off("game-ticked",this.onGameTicked),this.$mainHub.$off("game-over",this.onGameOver),this.$mainHub.$off("game-paused",this.onGamePaused),this.$mainHub.$off("game-resumed",this.onGameResumed),window.removeEventListener("keydown",this.onKeyPress),this.worker=null},methods:{leaveTheGame:function(t){var e=this;t?this.$mainHub.leaveGame(this.gameUid,this.profile.email,Number(this.playerNum)).then((function(){e.$router.push("/")})).catch((function(){})):this.$bvModal.msgBoxConfirm("Are you sure you want to leave the game?",{title:"Game exit",size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:"YES",cancelTitle:"NO",footerClass:"p-2",hideHeaderClose:!1,centered:!0}).then((function(t){t&&e.$mainHub.leaveGame(e.gameUid,e.profile.email,Number(e.playerNum)).then((function(){e.$router.push("/")})).catch((function(){}))})).catch((function(){}))},pauseGame:function(){this.$mainHub.pauseGame(this.gameUid,this.profile.email)},resumeGame:function(){this.$mainHub.resumeGame(this.gameUid,this.profile.email)},onPlayerJoined:function(t,e,i){this.setPlayers(e,i)},onPlayerLeft:function(t,e,i,a){var n=this;this.setPlayers(i,a),this.$bvModal.msgBoxOk("".concat(e," left the game!")).then((function(){n.leaveTheGame(!0)})).catch((function(){}))},setPlayers:function(t,e){this.player1=t,this.player2=e},playerMove:function(t,e,i){this.$mainHub.playerMove(t,e,i)},onGameStart:function(t){this.game=t,this.gameStarted=!0,1===this.playerNum&&this.setInterval()},onGameTicked:function(t,e,i,a,n,s){var o=this;this.counter=e,h.gameTick(this.player1,this.player2,i,a,n,s),this.startDraw(),this.worker.postMessage("outOfBoundariesCheck",[this.myself.points,this.game.width,this.game.height]).then((function(t){t&&(o.outOfBoundaries=!0,o.$mainHub.outOfTheBoundaries(o.gameUid,o.profile.email,Number(o.playerNum)))})).catch(),this.worker.postMessage("collideOpponentCheck",[this.myself.points[0],this.opponent.points]).then((function(t){t&&(o.collisionDetected=!0,o.$mainHub.outOfTheBoundaries(o.gameUid,o.profile.email,Number(o.playerNum)))})).catch(),this.worker.postMessage("collideMyselfCheck",[this.myself.points]).then((function(t){t&&(o.collisionDetected=!0,o.$mainHub.outOfTheBoundaries(o.gameUid,o.profile.email,Number(o.playerNum)))})).catch()},onGameOver:function(t,e,i){this.gameStarted=!1,this.stats.winner=e,this.stats.score=i,this.showGameStatistics()},onGamePaused:function(t,e){this.gamePaused=!0,this.$bvToast.toast(e,{toaster:"b-toaster-bottom-full",title:"Game paused",variant:"warning",solid:!0,appendToast:!0})},onGameResumed:function(t,e){this.gamePaused=!1,this.$bvToast.toast(e,{toaster:"b-toaster-bottom-right",title:"Game resumed",variant:"info",solid:!0,appendToast:!0})},showGameStatistics:function(){this.statisticsModalShow=!0},startDraw:function(){var t=this,e=function e(){h.draw(t.provider,t.game,t.player1,t.player2,t.elementSize),requestAnimationFrame(e)};e()},onKeyPress:function(t){var e=this.keysToDirections[t.keyCode];this.gameStarted&&e&&(console.log(e),this.playerMove(this.gameUid,this.playerNum,e))},setInterval:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=this;this.interval=setInterval((function(){t.gameStarted&&!t.gamePaused&&t.gameTick()}),this.timerInerval)})),gameTick:function(){this.$mainHub.gameTick(this.gameUid)},onStatsModalClose:function(){Object.assign(this.stats,{winner:"",score:""}),this.statisticsModalShow=!1,this.$router.push("/")}},watch:{outOfBoundaries:function(t){t&&this.$bvToast.toast("You went out of boudaries!",{toaster:"b-toaster-bottom-right",title:"Out of boudaries",variant:"warning",solid:!0,appendToast:!0})},collisionDetected:function(t){t&&this.$bvToast.toast("You collided youself ot your opponent!",{toaster:"b-toaster-bottom-right",title:"Collision detected",variant:"warning",solid:!0,appendToast:!0})}}},w=y,$=(i("8e33"),Object(g["a"])(w,a,n,!1,null,"72ebb068",null));e["default"]=$.exports},"81d5":function(t,e,i){"use strict";var a=i("7b0b"),n=i("23cb"),s=i("50c4");t.exports=function(t){var e=a(this),i=s(e.length),o=arguments.length,r=n(o>1?arguments[1]:void 0,i),u=o>2?arguments[2]:void 0,c=void 0===u?i:n(u,i);while(c>r)e[r++]=t;return e}},"8e33":function(t,e,i){"use strict";var a=i("d7e9"),n=i.n(a);n.a},a9e3:function(t,e,i){"use strict";var a=i("83ab"),n=i("da84"),s=i("94ca"),o=i("6eeb"),r=i("5135"),u=i("c6b6"),c=i("7156"),l=i("c04e"),h=i("d039"),m=i("7c73"),f=i("241c").f,d=i("06cf").f,p=i("9bf2").f,g=i("58a8").trim,v="Number",b=n[v],y=b.prototype,w=u(m(y))==v,$=function(t){var e,i,a,n,s,o,r,u,c=l(t,!1);if("string"==typeof c&&c.length>2)if(c=g(c),e=c.charCodeAt(0),43===e||45===e){if(i=c.charCodeAt(2),88===i||120===i)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:a=2,n=49;break;case 79:case 111:a=8,n=55;break;default:return+c}for(s=c.slice(2),o=s.length,r=0;r<o;r++)if(u=s.charCodeAt(r),u<48||u>n)return NaN;return parseInt(s,a)}return+c};if(s(v,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var x,k=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof k&&(w?h((function(){y.valueOf.call(i)})):u(i)!=v)?c(new b($(e)),i,k):$(e)},S=a?f(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),N=0;S.length>N;N++)r(b,x=S[N])&&!r(k,x)&&p(k,x,d(b,x));k.prototype=y,y.constructor=k,o(n,v,k)}},cb29:function(t,e,i){var a=i("23e7"),n=i("81d5"),s=i("44d2");a({target:"Array",proto:!0},{fill:n}),s("fill")},d7e9:function(t,e,i){},e5e1:function(t,e,i){t.exports=i.p+"img/cup1.075ad50e.png"}}]);
//# sourceMappingURL=chunk-92f80c4c.538b765f.js.map